<!DOCTYPE html>
<html>
  <head>
    <title>Tic Tac Toe for Windows 95 , IE 3.0</title>
  </head>

  <body background="base.gif">
    <script language="JavaScript">
      var ResNorm = 0,
        ResWin = 1,
        ResDraw = 2,
        ResStart = 3;
      var Result = ResStart;

      function Set(Str, Off, Val) {
        // Set the value at the specified offset in the string
        return Str.substring(0, Off) + Val + Str.substring(Off + 1);
      }

      function Get(Str, Off) {
        // Get the value at the specified offset in the string
        return -(-Str.substring(Off, Off + 1));
      }

      function Sum(Str, a, b, c) {
        // Sum the values at the specified offsets in the string
        return Get(Str, a) + Get(Str, b) + Get(Str, c);
      }

      function MyMove(Dat) {
        //do computer's move
        var PosLines,
          Order = "2613",
          PosCorns;
        var j, i, a, b, c;

        //if computer's in centre
        PosLines =
          Get(Dat, 5) == 1
            ? "132798174396546528519537"
            : "519537132798174396546528";
        PosCorns = Get(Dat, 5) == 1 ? "124326748968" : "542526548586";

        Result = ResWin;

        for (j = 0; j < 4; j++) {
          for (i = 0; i < 24; i += 3) {
            a = Get(PosLines, i);
            b = Get(PosLines, i + 1);
            c = Get(PosLines, i + 2);
            if (Sum(Dat, a, b, c) == Get(Order, j)) {
              return Get(Dat, a) == 0
                ? Set(Dat, a, 1)
                : Get(Dat, b) == 0
                ? Set(Dat, b, 1)
                : Get(Dat, c) == 0
                ? Set(Dat, c, 1)
                : undefined;
            }
          }

          Result = ResNorm;

          if (j == 1) {
            //only between 2nd and 3rd passes
            for (i = 0; i < 12; i += 3) {
              a = Get(PosCorns, i);
              b = Get(PosCorns, i + 1);
              c = Get(PosCorns, i + 2);
              if (Sum(Dat, a, b, c) == 6)
                return Get(Dat, a) == 0 ? Set(Dat, a, 1) : undefined;
            }
          }
        }

        Result = ResDraw; //no places to go

        return Dat;
      }

      // Plot the board
      function DrawTable(Dat) {
        var i, Sqr;
        var html = "<center>";
        html += "<h1>Tic-Tac-Toe for Windows 95, Internet Explorer 3.0</h1>";

        for (i = 1; i <= 9; i++) {
          Sqr = Get(Dat, i);

          if (Sqr == 0) {
            if (Result == ResWin) {
              //no more links if it's been won
              html += '<IMG ALIGN=bottom SRC="gameb.gif">';
            } else {
              //a link for human moves
              html +=
                '<A HREF="index.html' +
                Set(Dat, i, "3") +
                '"><IMG ALIGN=bottom BORDER=0 SRC="gameb.gif"></A>';
            }
          } else if (Sqr == 3) {
            // it's an X
            html += '<IMG ALIGN=bottom SRC="gamex.gif">';
          } else {
            // must be an O
            html += '<IMG ALIGN=bottom SRC="gameo.gif">';
          }

          if (i == 9) {
            // finished
            html += "<P>";
          } else if (i == 3 || i == 6) {
            // long horizontal line
            html += '<br><IMG ALIGN=bottom  SRC="gamedh.gif"><br>';
          } else {
            // vertical line
            html += '<IMG ALIGN=bottom SRC="gamedv.gif">';
          }
        }

        html += "<H2>"; //make comments

        if (Result == ResDraw)
          html +=
            'It\'s a draw!<BR>Want <A HREF="index.html">another game</A>?';
        else if (Result == ResStart) html += "Your go first ...";
        else if (Result == ResWin)
          html += 'I won!<BR>Like to <A HREF="index.html">play again</A>?';

        html += "<BR></H2>";
        html += "<p><b>Created by Povilas, 2023</b> </p>";
        html += "</center>";

        document.write(html);
      }

      DrawTable(
        location.search.length == 10 ? MyMove(location.search) : "?000000000"
      ); // draw a load of blanks if just started
    </script>
  </body>
</html>
